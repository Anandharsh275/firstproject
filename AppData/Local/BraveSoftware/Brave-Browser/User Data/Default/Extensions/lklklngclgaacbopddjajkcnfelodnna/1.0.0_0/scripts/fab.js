!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var a=t();for(var i in a)("object"==typeof exports?exports:e)[i]=a[i]}}(self,(function(){return(()=>{var e=e||null,t=0,a=0,i="";function n(t){e=t;try{var a=t,i="";i=window.vbrowser.httpGetCookie?window.vbrowser.httpGetCookie(e):document.cookie;vbase.app_xhr_adv(t,a,i,"Mozilla/5.0 (Linux; Android 8.1.0; CPH1809 Build/OPM1.171019.026; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/75.0.3770.101 Mobile Safari/537.36","get","")}catch(e){return vbase.error_default("facebook 1"),null}}function r(e){return e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/&quot;/g,'"')).replace(/&#123;/g,"}")).replace(/&amp;/g,"&")).replace(/u003C/g,"<")).replace(/\\3a/i,":")).replace(/\\26/g,"&")).replace(/\\3d/g,"=")).replace(/\\25/g,"%")).replace(/\\/g,"")).replace(/&#039;/g,"'")).replace(/ /g,"")}function o(e,a,i){t=0;for(var n=[];t<e.length;){var r=l(e,a,i);if(null==r)break;n.push(r)}return t=0,n}function l(e,a,i){var n=a.length,r=e.indexOf(a,t);if(-1==r)return null;r+=n;var o=e.indexOf(i,r);return-1==o?null:(t=o+i.length,e.substring(r,o))}function d(e,t,a){var i=t.length,n=e.indexOf(t);if(-1==n)return"";n+=i;var r=e.indexOf(a,n);return-1==r?"":e.substring(n,r)}function s(){if("m.facebook.com"===location.host){for(var e=[],t=document.getElementsByTagName("i"),a=0;a<t.length;a++){var i=t[a],n=i.getAttribute("data-sigil");if("photo-image"==n)i=t[a].parentNode,e.push(i);else if("playInlineVideo"==n){if((i=t[a].parentNode).getElementsByClassName("_3vvg").length>0)continue;e.push(i)}else"cover-photo orientation-resizable"==n&&(i=i.parentNode.parentNode,e.push(i))}var r=document.getElementsByClassName("story_body_container");for(a=0;a<r.length;a++)if(!((i=r[a]).getElementsByClassName("story_body_container").length>0||i.getElementsByClassName("_3vvg").length>0))if(i.getElementsByClassName("_53mw").length>0)e.push(i);else if(i.getElementsByTagName("i").length>0)for(var o=i.getElementsByTagName("i"),l=0;l<o.length;l++){var d=o[l].getAttribute("class");"null"!=o[l].getAttribute("style")&&-1!=d.indexOf("4s0y")&&e.push(i)}for(var s=document.getElementsByTagName("img"),g=0;g<s.length;g++){var p=(i=s[g]).getAttribute("alt");null!=p&&-1!=p.indexOf("Image")&&(i=i.parentNode,e.push(i))}for(a=0;a<e.length;++a){if(-1==(y=e[a]).innerHTML.indexOf('class="download"')){if(y.getElementsByClassName("_4s0y").length>0){var f=y.getElementsByClassName("_4s0y")[0].parentElement.parentElement.parentElement;f&&"A"===f.nodeName?y.style.position="relative":y=y.getElementsByClassName("_4s0y")[0].parentElement}(_=document.createElement("div")).className="download",_.style.cssText=`position: absolute;z-index: 99999; bottom: 6px; right: 4px; background: ${vbase.download_btn_color}; width: 54px; height:54px; border-radius: 50%;`,_.innerHTML=`<img width='100%' height='100%' src='${vbase.download_btn_icon}'/>`,_.addEventListener("click",u,!1),y.appendChild(_)}}var h=document.querySelector("html").innerHTML,v=document.querySelectorAll('[data-type="video"][data-is-live-streaming="false"][data-video-url]');for(a=0;a<v.length;++a){if(-1==(y=v[a]).innerHTML.indexOf('class="download"'))(_=document.createElement("div")).className="download",-1!==h.indexOf("dpb_M84f0US.png")&&-1!==h.indexOf("mIKkq7DwTGn.png")?_.style.cssText=`position: absolute;z-index: 99999; bottom: calc(90px * var(--dpr)); right: 4px; background: ${vbase.download_btn_color}; width: calc(54px * var(--dpr)); height:calc(54px * var(--dpr)); border-radius: 50%;`:_.style.cssText=`position: absolute;z-index: 99999; bottom: 6px; right: 4px; background: ${vbase.download_btn_color}; width: calc(54px * var(--dpr)); height:calc(54px * var(--dpr)); border-radius: 50%;`,_.innerHTML=`<img width='100%' height='100%' src='${vbase.download_btn_icon}'/>`,_.addEventListener("click",m,!1),y.appendChild(_)}if(-1!==h.indexOf("dpb_M84f0US.png")&&-1!==h.indexOf("mIKkq7DwTGn.png"))return;var b=document.querySelectorAll('div[data-mcomponent="ImageArea"][data-action-id].m > img[data-image-id].img.contain, div[data-mcomponent="ServerImageArea"][data-action-id].m > img[data-image-id].img.contain, div[data-mcomponent="ServerImageArea"][data-comp-id].m > img[data-image-id].img.contain');for(a=0;a<b.length;++a){var _;if(-1===(y=b[a].parentNode).getAttribute("style").indexOf("margin-left:1px;")&&-1===y.getAttribute("style").indexOf("margin-left:2px;"))if(-1==y.innerHTML.indexOf('class="download"'))(_=document.createElement("div")).className="download",_.style.cssText=`position: absolute;z-index: 99999; bottom: 6px; right: 4px; background: ${vbase.download_btn_color}; width: calc(54px * var(--dpr)); height:calc(54px * var(--dpr)); border-radius: 50%;`,_.innerHTML=`<img width='100%' height='100%' style="pointer-events: auto;" src='${vbase.download_btn_icon}'/>`,_.addEventListener("click",m,!1),y.appendChild(_)}}else if("www.facebook.com"===location.host){for(v=document.querySelectorAll("._6x84 div[data-instancekey"),a=0;a<v.length;++a){c(y=v[a])}if("/watch/shows"!==location.pathname){v=document.querySelectorAll(".l9j0dhe7[id] div[data-instancekey");for(a=0;a<v.length;++a){c(y=v[a])}}v=document.querySelectorAll('[data-pagelet="WatchPermalinkVideo"] div[data-instancekey');for(a=0;a<v.length;++a){c(y=v[a])}v=document.querySelectorAll(".h7zd8jcd>.cxj30y35 div[data-instancekey");for(a=0;a<v.length;++a){c(y=v[a])}v=document.querySelectorAll(".kvgmc6g5.cxmmr5t8.oygrvhab.hcukyx3x>.cxj30y35 div[data-instancekey");for(a=0;a<v.length;++a){c(y=v[a])}v=document.querySelectorAll('[data-pagelet="TahoeVideo"] div[data-instancekey');for(a=0;a<v.length;++a){c(y=v[a])}if(/\/watch\/.*\//.test(document.URL)||/\/.*\/videos/.test(document.URL)){v=document.querySelectorAll(".tqsryivl.datstx6m.ni8dbmo4.stjgntxs.l9j0dhe7.k4urcfbm .k4urcfbm.l9j0dhe7.datstx6m.a8c37x1j.du4w35lb>div[data-instancekey]");for(a=0;a<v.length;++a){var y;c(y=v[a])}}for(s=document.querySelectorAll('div[role="article"][class="lzcic4wl"] .l9j0dhe7 .l9j0dhe7 img.i09qtzwb.n7fi1qx3.datstx6m.pmk7jnqg.j9ispegn.kr520xx4.k4urcfbm'),a=0;a<s.length;++a)for(var w=s[a],x=!0;x&&"BODY"!=w.tagName;)"A"===(w=w.parentNode).tagName&&(x=!1,c(w))}}function c(e){if(-1==e.innerHTML.indexOf('class="download"')&&null==e.querySelector('.pq6dq46d.cgat1ltu.l9j0dhe7>i[data-visualcompletion="css-img"]')){var t=document.createElement("div");t.className="download",t.style.cssText=`position: absolute;z-index: 99999; bottom: 40px; right: 4px; background: ${vbase.download_btn_color}; width: 54px; height:54px; border-radius: 50%;cursor: pointer;`,t.innerHTML=`<img width='100%' height='100%' src='${vbase.download_btn_icon}'/>`,t.addEventListener("click",u,!1),e.appendChild(t)}}window.video_analytics=function(e){try{var t=new video,i=new video_author;t.check_type="facebook",t.js_ver="5.05",t.js_info="fail_count";var r=d(e,"<title>","</title>"),o=d(e,'{"__bbox":{"complete":false,"result":{"data":{"video":{"story":{"attachments":[','],"id":');if(o||(o=d(e,'"is_prod_eligible":true,"attachment":',',"__module_operation_CometFeedStoryAttachmentRendererInner_attachment"')),o||(o=d(e,'}},"attachments":[','],"comet_sections":{')),o?o=JSON.parse(o).media:(o=d(e,'{"__bbox":{"complete":false,"result":{"data":{"video":','},"extensions":'))&&(o=JSON.parse(o)),o){t.picture_default=o.preferred_thumbnail.image.uri,t.picture_big=t.picture_default,t.id=o.id;var l=null;try{var s=o.dash_manifest.match(/mediaPresentationDuration.*?PT(.*?S)/);if(null===s)l=null;else{var c=s[1];if(null!==c.match(/(\d*)H(\d*)M(.*?)S/))l=60*parseInt(c.match(/(\d*)H(\d*)M(.*?)S/)[1])*60+60*parseInt(c.match(/(\d*)H(\d*)M(.*?)S/)[2])+parseInt(c.match(/(\d*)H(\d*)M(.*?)S/)[3])}}catch(e){}if(o.playable_url_quality_hd){var g=new video_file;g.url=o.playable_url_quality_hd,g.f_id=t.id+"720",g.format="mp4",g.title="720p",g.type="video",g.thumbnail=o.preferred_thumbnail.image.uri,g.duration=l,t.files.push(g)}var u=new video_file;u.url=o.playable_url,u.f_id=t.id+"240",u.format="mp4",u.title="240p",u.type="video",u.thumbnail=o.preferred_thumbnail.image.uri,u.duration=l,t.files.push(u),o.owner&&o.owner.profile_picture&&(i.id=o.owner.id,i.username=o.owner.name,i.avatar=o.owner.profile_picture.uri,t.author=i)}var m=d(e,'"data":{"attachments":[',']},"errors"');if(m)r=(m=JSON.parse(m).media).title.text,i.id=m.owner.id,i.username=m.owner.name,i.avatar=m.owner.owner_as_page.profile_pic_uri,t.author=i;else{(m=d(e,'"is_prod_eligible":true,"story":{"message":{"text":',"},"))&&(r=JSON.parse(m));var p=d(e,'"is_prod_eligible":true,"story":{"actors":[','],"comet_sections":');p&&(p=JSON.parse(p),i.id=p.id,i.username=p.name,i.avatar=p.profile_picture.uri,t.author=i)}if(t.files.length<=0)return a<=0?(a+=1,void n(document.URL)):(vbase.error_default("not find media resource"),null);r.length<=0&&(r="facebook"),t.title=r,window.vbrowser.popupVideoInfo(JSON.stringify(t))}catch(e){}};var g="";function u(){if(""!=(g=event.target)){var e=g.parentNode;e&&("download"==e.className&&function(){if("m.facebook.com"===location.host){if(!1,""==g)return;var e=!1,t=g.parentNode.parentNode,a="",i="",l="",s="",c="";(L=new video).check_type="facebook",L.js_ver="5.0",L.js_info="super facebook downloader",L.url=document.url;var u=t.getElementsByClassName("_53mw");u.length<=0&&(u=t.parentNode.getElementsByClassName("_53mw"));var m=t.getElementsByTagName("i");if(m.length>0)for(var p=0;p<m.length;p++){var f=m[p].getAttribute("class"),h=m[p].getAttribute("data-sigil");if(null!=f&&-1!=f.indexOf(" _4s0y")||"cover-photo orientation-resizable"==h){if(null==(y=m[p].getAttribute("style")))continue;(s=d(y,"url('","'")).length<10&&(s=d(y,'url("','"')),(a=(s=r(s)).match("jpg?.*")).length>0?(a=a[0],L.id=a):(a=s,L.id=a);break}}if(u.length>0){c="";var v=d(S=r(S=u[0].getAttribute("data-store")),'mimeType="audio',"indexRange");if(v){var b=d(v,"http","<");if(b){var _="http"+b.replace(/amp;/g,"");c=_,(I=new video_file).url=_,I.f_id=L.id+"_mp3",I.format="mp3",I.title="audio",L.files.push(I)}}var y,w=o(S,"FBQualityLabel","FBFirstSegmentRange");if(w.length>0&&c)for(p=0;p<w.length;p++){var x,N=d(x=w[p],"http","</"),k=d(x,'="','"');N.length>10&&(i="http"+N.replace(/amp;/g,""),(I=new video_file).url=i,I.f_id=L.id+"_"+p,I.format="mp4",k.length<=0&&(k="mp4"),I.title=k,I.url_audio=c,I.type="video",0==e&&(e=!0),L.files.push(I))}0==e&&(w=d(S,'type":"video","src":"','"')).length>10&&((I=new video_file).url=w,I.f_id=L.id+"_100",I.format="mp4",I.title="mp4",I.type="video",L.files.push(I)),s||(m=t.getElementsByTagName("i")).length>0&&null!==(y=(m=m[0]).getAttribute("style"))&&((s=d(y,"url('","'")).length<10&&(s=d(y,'url("','"')),(a=(s=r(s)).match("jpg?.*")).length>0?(a=a[0],L.id=a):(a=s,L.id=a))}else if(s.length>10)(I=new vid_mate_video_file).url=s,I.f_id=L.id+"_jpg",I.format="jpg",I.title="jpg",I.type="image",L.files.push(I),e=!0;else{var j=t.getElementsByTagName("i");for(p=0;p<j.length;p++){var A=j[p],E=A.getAttribute("data-sigil"),S=A.getAttribute("data-store");"photo-image"==E&&"null"!=S&&((s=d(S,'imgsrc":"','"')).length<=10&&(s=d(S,'url("','"')),(s=s.replace(/\\/g,"")).length>10&&(i=s,a.length<=0&&((a=i.match("jpg?.*")).length>0?(a=a[0],L.id=a):(a=i,L.id=a)),(I=new video_file).url=s,I.f_id=a+"_jpg",I.format="jpg",I.title="jpg",I.type="image",L.files.push(I),e=!0))}}L.files.length<=0&&(x=t.getElementsByTagName("img")).length>=0&&(M=(x=x[0]).getAttribute("src")).length>10&&-1!=M.indexOf("jpg")&&((a=M.match("jpg?.*")).length>0?(a=a[0],L.id=a):(a=M,L.id=a),(I=new vid_mate_video_file).url=M,I.f_id=a+"_jpg",I.format="jpg",I.title="jpg",I.type="image",L.files.push(I),e=!0);for(var O=g.parentNode.parentNode;0==l.length&&null!=O&&"BODY"!=O.tagName&&"ARTICLE"!=O.tagName&&"article"!=O.tagName;){var T,q;if(null!=(q=O.getElementsByClassName("_5rgt _5nk5 _5msi"))&&q.length>0&&(T=q[0].getElementsByTagName("span")).length>0){l=T[0].innerText;break}if((null==q||q.length<=0)&&(q=O.getElementsByClassName("_5rgt _5nk5")).length>0&&(T=q[0].getElementsByTagName("p")).length>0){l=T[0].innerText;break}if((null==q||q.length<=0)&&(q=O.getElementsByClassName("msg")).length>0&&(l=q[0].innerText).length>0)break;if((null==q||q.length<=0)&&(q=O.getElementsByClassName("_52je _52jh")).length>0&&(l=q[0].innerText).length>0)break;O=O.parentNode}if(0==e&&L.files.length<=0)return vbase.error_default("not find media resource"),null;l.length<=0&&(l="Facebook"),L.title=l,L.picture_big=s,L.picture_default=s,vbase.setParseMsg(100,100,"Completed"),window.vbrowser.popupVideoInfo(JSON.stringify(L))}else if("www.facebook.com"===location.host){if(""==g)return;var B=g.parentNode.parentNode,C=B.querySelector("img.i09qtzwb.n7fi1qx3.datstx6m.pmk7jnqg.j9ispegn.kr520xx4.k4urcfbm");if(C){var L,M;if((L=new video).check_type="facebook",L.js_ver="5.0",L.js_info="super facebook downloader",L.title="Facebook",(M=C.getAttribute("src")).length>10){var I;a=M.match(/.*\/(.*)\.(jpg|jpeg|webp|png)/);try{a.length>1?(a=a[1],L.id=a):(a=M,L.id=a)}catch(e){a=+new Date}(I=new video_file).url=M,I.f_id=a+"_jpg",I.format="jpg",I.title="jpg",I.type="image",I.thumbnail=M,L.files.push(I),L.picture_default=M,L.picture_big=M;try{window.vbrowser.popupVideoInfo(JSON.stringify(L))}catch(e){return vbase.error_default("Pop info error"),null}}return}var H=B.querySelector("a"),z="";if(!H)for(var P=!0;P&&"BODY"!=B.tagName;)"A"===(B=B.parentNode).tagName&&-1!==B.parentNode.parentNode.className.indexOf("l9j0dhe7")&&(P=!1,H=B);H&&(z=H.getAttribute("href")),z&&!/\/watch\/.*\/\?/.test(z)?n(z=(-1===z.indexOf("http")?window.location.origin:"")+z):window.video_analytics(document.documentElement.innerHTML)}}(),event.stopPropagation(),event.preventDefault())}}function m(){if(""!=(g=event.target)){var e=g.parentNode;e&&("download"==e.className&&function(){if(!1,""!=g){var e=!1,t="",a="",i=g.parentNode.parentNode;i.getAttribute("data-video-url")?t=i:"ImageArea"!==i.getAttribute("data-mcomponent")&&"ServerImageArea"!==i.getAttribute("data-mcomponent")||(a=i);var n="",r="",o="",l="",d=new video;if(d.check_type="facebook",d.js_ver="5.0",d.js_info="super facebook downloader",d.url=document.URL,t)n=t.getAttribute("data-video-id"),r=t.getAttribute("data-video-url"),l=t.querySelector(".img.contain").getAttribute("src"),(s=new video_file).url=r,s.f_id=n+"_1",s.format="mp4",s.title="720p",s.type="video",s.thumbnail=l,d.files.push(s),e=!0;else if(a){var s,c=a.querySelector("img.img");n=c.getAttribute("data-image-id"),l=r=c.getAttribute("src"),(s=new video_file).url=r,s.f_id=n+"_jpg",s.format="jpg",s.title="jpg",s.type="image",s.thumbnail=l,d.files.push(s),e=!0}if(0==e&&d.files.length<=0)return vbase.error_default("not find media resource"),null;o.length<=0&&(o="Facebook"),d.id=n,d.title=o,d.picture_big=l,d.picture_default=l,vbase.setParseMsg(100,100,"Completed"),window.vbrowser.popupVideoInfo(JSON.stringify(d))}}(),event.stopPropagation())}}return window.startObserver=function(){var e;s(),e=document,(i=new MutationObserver((function(e){s()}))).observe(e,{childList:!0,subtree:!0})},window.removeObserver=function(){i&&i.disconnect(),document.querySelectorAll("div.download").forEach((e=>{e.remove()}))},{}})()}));